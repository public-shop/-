<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>สำนักป้ายยา</title>
<link rel="icon" href="Image/profile.png" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<script>
    // แปลง base64 กลับเป็น HTML และเพิ่มลิงก์ CSS
    var base64Link = 'PGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL3B1YmxpYy1zaG9wLmdpdGh1Yi5pby9jc3Mvc3R5bGUuY3NzIj4=';
    var decodedLink = atob(base64Link);
    var parser = new DOMParser();
    var doc = parser.parseFromString(decodedLink, 'text/html');
    var linkTag = doc.querySelector('link');
    document.head.appendChild(linkTag);
</script>
</head>
<body>
<div class="profile-container">
    <div class="cover-image">
        <img src="Image/profilebackground.jpg" alt="Image profilebackground Image" loading="lazy">
        <div class="profile-img-wrapper">
            <img class="profile-img" src="Image/profile.png" alt="profile Image" loading="lazy">
        </div>
    </div>

    <h1>สำนักป้ายยา</h1>
    <p class="bio">รวบรวมของที่น่าสนใจให้กับคุณ</p>
    <p class="bio">สุดยอดไอเท็มที่ไม่ควรพลาด</p>

    <div class="social-links">
        <a href="https://www.instagram.com/public_s_h_o_p?igsh=MXI0aW5sMjZnd2UzaA==" target="_blank" class="instagram" aria-label="Instagram">
            <i class="fab fa-instagram"></i> IG
        </a>
        <a href="https://s.lemon8-app.com/al/GgZjpjvFxp" target="_blank" class="lemon8" aria-label="Lemon8">
            <i class="fas fa-lemon"></i> Lemon8
        </a>
        <a href="https://www.threads.net/@public_s_h_o_p" target="_blank" class="threads" aria-label="Threads">
            <i class="fab fa-threads"></i> Threads
        </a>
        <a href="https://youtube.com/@public_s_h_o_p?si=bFPcscBQp7o-jrDU" target="_blank" class="youtube" aria-label="YouTube">
            <i class="fab fa-youtube"></i> YouTube
        </a>
        <a href="https://www.facebook.com/share/1DUayMV4mi/" target="_blank" class="facebook" aria-label="Facebook">
            <i class="fab fa-facebook-f"></i> Facebook
        </a>
    </div>

    <div class="search-box">
        <div class="search-container">
            <input type="text" id="search-input" placeholder="กรุณากรอกรหัสสินค้า...">
            <button onclick="searchProducts()">ค้นหา</button>
        </div>
    </div>

    <h1>สินค้าทั้งหมด</h1>
    <div class="products" id="product-container"></div>
</div>

<script>
    let allProducts = [];

    // ฟังก์ชันถอดรหัส Base64
    function decodeBase64(encodedString) {
        return atob(encodedString);
    }

    async function fetchProducts() {
        try {
            const encodedUrl = 'aHR0cHM6Ly9wdWJsaWMtc2hvcC5naXRodWIuaW8vZGF0YWJhc2UvZGF0YWJhc2UuanNvbg==';
            const apiUrl = decodeBase64(encodedUrl);
            const response = await fetch(apiUrl);
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            allProducts = await response.json();
            displayProducts(allProducts);
        } catch (error) {
            console.error('เกิดข้อผิดพลาดในการดึงข้อมูลสินค้า:', error);
            alert('ไม่สามารถดึงข้อมูลสินค้าได้ กรุณาลองใหม่ในภายหลัง');
        }
    }

    function displayProducts(products) {
        const productContainer = document.getElementById('product-container');
        productContainer.innerHTML = '';

        products.forEach(product => {
            const productItem = document.createElement('div');
            productItem.classList.add('product-item');
            productItem.innerHTML = `
                <i class="fab fa-shopify"></i>
                <p class="product-name">${product.name}</p>
            `;

            productItem.addEventListener('click', () => {
window.location.href = product.linkshopee; // เปิดลิงก์ในแท็บเดิม
});

            productContainer.appendChild(productItem);
        });
    }

//ระบบเช็คแจ้งเตือนตรวจสอบ
    function searchProducts() {
let searchInput = document.getElementById('search-input').value;

// เช็กกรณีที่ไม่มีการกรอกข้อความ
if (searchInput === "") {
    alert("กรุณากรอกรหัสสินค้า");
    return;
}

// เช็กว่ามีช่องว่างที่หน้าแรกหรือหลัง
if (searchInput.startsWith(" ") || searchInput.endsWith(" ")) {
    alert("กรุณากรอกโดยไม่มีช่องว่าง");
    return;
}

// ตัดช่องว่างและแปลงเป็นตัวพิมพ์เล็ก
searchInput = searchInput.trim().toLowerCase();

// เช็กว่ามีช่องว่างระหว่างคำ
if (searchInput.includes(" ")) {
    alert("กรุณากรอกโดยไม่มีช่องว่าง");
    return;
}

// กรองสินค้าที่ตรงกับคำที่กรอก
const filteredProducts = allProducts.filter(product =>
    product.name.toLowerCase().includes(searchInput)
);

// ถ้าไม่พบสินค้าแสดงข้อความ
if (filteredProducts.length === 0) {
    alert("ไม่พบสินค้าที่ตรงกับรหัสที่คุณกรอก");
} else {
    displayProducts(filteredProducts);  // แสดงผลลัพธ์
}
}

window.addEventListener('load', fetchProducts);

    function resizeCoverImage() {
        let cover = document.querySelector(".cover-image");
        let viewportHeight = window.innerHeight * 0.3;
        cover.style.height = viewportHeight + "px";
    }

    window.addEventListener("load", resizeCoverImage);
    window.addEventListener("resize", resizeCoverImage);
</script>
</body>
</html>